# 액셀

개요 : 조금 더 액셀을 편하고 빠르게 다뤄보자!

## 업무 시간이 단축되는 데이터 변환 기법

- 빈 셀 선택후 데이터 동시 입력
  
  ![1. 빈 셀 선택후 데이터 동시 입력.gif](assets/01.%20%EB%B9%88%20%EC%85%80%20%EC%84%A0%ED%83%9D%ED%9B%84%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EB%8F%99%EC%8B%9C%20%EC%9E%85%EB%A0%A5.gif)
  1. 원하는 테이블에서 Ctrl+A로 범위 선택
  2. 메뉴 홈 > 찾기 및 선택 > 이동 옵션 > 빈 셀
  3. 입력하고 싶은 정보 입력하고 Ctrl+Enter
- 병합 셀 포함 테이블을 특정 기준으로 정렬
  
  ![2.병합 셀 포함 테이블을 특정 기준으로 정렬.gif](assets/02.%EB%B3%91%ED%95%A9%20%EC%85%80%20%ED%8F%AC%ED%95%A8%20%ED%85%8C%EC%9D%B4%EB%B8%94%EC%9D%84%20%ED%8A%B9%EC%A0%95%20%EA%B8%B0%EC%A4%80%EC%9C%BC%EB%A1%9C%20%EC%A0%95%EB%A0%AC.gif)
  1. 병합 셀 컬럼을 클릭 후 [홈 > 병합하고 가운데 맞춤]으로 해제
  2. 메뉴 홈 > 찾기 및 선택 > 이동 옵션 > 빈 셀
  3. 수식을 입력하고, Ctrl+Enter
  4. 해달 컬럼 복사 후 값 붙여 넣기 선택
  5. 이후, [홈>정렬 및 필터]로 정렬
- 불필요한 문자 바꾸기로 일괄 변경
  
  ![3. 불필요한 문자 바꾸기로 일괄 변경.gif](assets/03.%20%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C%20%EB%AC%B8%EC%9E%90%20%EB%B0%94%EA%BE%B8%EA%B8%B0%EB%A1%9C%20%EC%9D%BC%EA%B4%84%20%EB%B3%80%EA%B2%BD.gif)
  1. 범위 지정하고 찾아바꾸기로 일괄 삭제
  2. 해당 범위의 셀 서식 선택(Ctrl+1)
  3. 셀 서식 > 맞춤 > 텍스트 맞춤 > 가로 > 균등 분할(들여쓰기)로 변경
  4. 우측 들여쓰기 값은 0에서 1로 변경
- 표의 0을 *로 일괄 변경
  
  ![4. 표의 0을 별로 일괄 변경.gif](assets/04.%20%ED%91%9C%EC%9D%98%200%EC%9D%84%20%EB%B3%84%EB%A1%9C%20%EC%9D%BC%EA%B4%84%20%EB%B3%80%EA%B2%BD.gif)
  1. 그냥 찾아 바꾸기로 할 경우 30이 3*이 되어버림
  2. 찾아 바꾸기에서 전체 셀 내용 일치를 선택
- 여러 줄을 한 줄 입력으로 바꾸기
  
  ![5. 여러 줄을 한 줄 입력으로 바꾸기.gif](assets/05.%20%EC%97%AC%EB%9F%AC%20%EC%A4%84%EC%9D%84%20%ED%95%9C%20%EC%A4%84%20%EC%9E%85%EB%A0%A5%EC%9C%BC%EB%A1%9C%20%EB%B0%94%EA%BE%B8%EA%B8%B0.gif)
  1. 찾아바꾸기에서 아스키 코드를 활용. 찾을 내용에 Alt+1,0, 바꿀 내용에 Space를 각각 입력
- A/B의 형태를 각각의 컬럼으로 분리
  
  ![6. AB의 형태를 각각의 컬럼으로 분리.gif](assets/06.%20AB%EC%9D%98%20%ED%98%95%ED%83%9C%EB%A5%BC%20%EA%B0%81%EA%B0%81%EC%9D%98%20%EC%BB%AC%EB%9F%BC%EC%9C%BC%EB%A1%9C%20%EB%B6%84%EB%A6%AC.gif)
  1. 하나의 컬럼 선택 후 데이터 > 텍스트 나누기
  2. 텍스트 마법사 1단계 : [구분 기호로 분리됨] 선택
  3. 텍스트 마법사 2단계 : 구분 기호 기타에 / 입력
  4. 텍스트 마법사 3단계 : 특별한 데이터 선택을 원하지 않는다면 일반으로 마침
- 데이터 중 필요 없는 부분 제거
  
  ![7. 데이터 중 필요 없는 부분 제거.gif](assets/07.%20%EB%8D%B0%EC%9D%B4%ED%84%B0%20%EC%A4%91%20%ED%95%84%EC%9A%94%20%EC%97%86%EB%8A%94%20%EB%B6%80%EB%B6%84%20%EC%A0%9C%EA%B1%B0.gif)
  1. 해당 컬럼 선택 후 데이터 > 텍스트 나누기
  2. 텍스트 마법사 1단계 : [너비가 일정함] 선택
  3. 텍스트 마법사 2단계 : 원하는 너비로 마우스 이동
  4. 텍스트 마법사 3단계 : 우측 열 클릭 후 열 가져오지 않음 선택하고 마침
- 잘못 된 형식 변환 (표시만 바뀌는 셀 서식과 다르게 형식 자체를 변환)
  
  ![8. 잘못 된 형식 변환.gif](assets/08.%20%EC%9E%98%EB%AA%BB%20%EB%90%9C%20%ED%98%95%EC%8B%9D%20%EB%B3%80%ED%99%98.gif)
  1. 해당 컬럼 선택 후 데이터 > 텍스트 나누기
  2. 텍스트 마법사 1, 2단계를 건너뛰어 나누지 않고 3단계에 일반 확인 후 마침
  3. 그 이후 셀 서식으로 원하는 형태로 변경도 가능
- 서식 복사
  
  ![9. 서식 복사.gif](assets/09.%20%EC%84%9C%EC%8B%9D%20%EB%B3%B5%EC%82%AC.gif)
  1. 셀 서식만 복사 할 수 있음

## 수식과 함수 사용에 필요한 핵심 기법

- 참조 (F4로 변경)
  - A1 : 상대 참조
  - $A1 : 열 고정
  - A$1 : 행 고정
  - \$A$1 : 절대 참조
    - 이름상자/이름관리자의 이름으로도 가능(수식이 짧아지고 타 시트에서 활용 가능)
    - 이름은 선택영역을 사용하여 빠르게 다수를 만들 수 있다.
- IF(조건,true일때 값, false일때 값) vs IFERROR(수식, 에러일때 대체할 값)
  - 0이 아니면 나눠라 vs 나누고 에러가 나면 처리해라
- VLOOKUP(찾을기준값, 기준 범위(열), 가져올열번호(1부터 시작), 검색 옵션)
  - 검색 옵션 : 0(False)이면 정확히 일치, 1(True)이면 낮은쪽 근사값
  - 검색이 안되는 경우 등을 고려하여, IFERROR과 섞어쓰자
- OFFSET(출발셀, 이동 행 수[상하], 이동 열 수[좌우])
- 갯수 세기
  - Count(범위) : 범위 내 숫자 데이터 개수
  - CountA(범위) : 범위 내 모든 데이터 개수
  - Countif(범위, 조건) : 조건에 맞는 데이터 개수
  - CountifS(범위1, 조건1, 범위2, 조건2 ...) : 여러 조건에 맞는 데이터 개수
    - 조건
    1. 문자 조건 : "경기"
    2. 대표 문자 조건 : "김*"
    3. 숫자 데이터 조건 : ">=30"
    4. 해당 데이터와 동일 : C2 같이 셀 입력
- SUMIF(비교 범위, 조건, 합을 계산할 범위)
- WEEKDAY(날짜, [Type]) : 지정한 날짜의 요일을 숫자(1~7)로 표시하는 함수. 일요일이 1
  - CHOOSE(숫자, 숫자가1일때값, 숫자가2일때값...)을 조합하면 월화수목금토 표현이 가능

## 기능

- 데이터 > 중복된 항목 제거 : 엄청 자주 쓰임!
- 데이터 > 데이터 유효성 검사 : 드롭다운을 만들 수 있음
  - 선택하지 않아도 기본값이 있는 콤보 상자와 드랍다운은 다름
- 개발도구 > 삽입 > 양식 컨트롤에서 콤보 상자 만들기 : 셀과 연동 가능
  - 상단 메뉴 없을 경우, 옵션 > 리본 사용자 지정 > 기본탭에 개발 도구 활성화
  - ActiveX 컨트롤은 기본적으로 셀과 연동되지 않고, VBA등으로 연동해야 작동
  1. 생성된 콤보상자 우 클릭 후, 컨트롤 서식 선택
  2. 입력 범위와 셀 연결(선택한 값을 보여줄 출력 셀) 설정
- 번호 매기기 : ROW()-열번호로 먹이면 유용
- 홈 > 조건부 서식
  1. 조건 설정
  2. 서식으로 색상 등 설정
  - 홈 > 조건부 서식 > 규칙 관리에서 수정 삭제가 가능
- 홈 > 자동합계 : 그룹(테이블)을 선택후 자동합계를 누르면 마지막 빈칸에 알아서 소계 합계 됨
- 정산 내역 시트로 붙여 넣기
  1. 컨트롤로 옮기고 싶은 부분을 복사
  2. 복사하고 싶은 테이블에 [연결하여 붙여넣기]
- 피벗 테이블 : 테이블 선택 후, [삽입 > 피벗테이블]로 생성
  - 피벗 테이블 도구
  - 피벗 테이블 필드
    - 예시 : 열에 거래일자(월), 행에 사용부서, 값에 금액을 두면 부서의 월벌 사용금액
    - 2010 버전은 월별 설정을 하려면 날짜를 드래그하고 월로 그룹하면 된다
  - GETPIVOTDATA로 피벗 테이블의 정보를 가져올 수 있음
    - GETPIVOTDATA(값 필드명, 피벗 보고서 작성 위치, 열 필드 명, 열 조건, 행 필드명, 행 조건)
    - 클릭으로도 가져올 수 있음. 하나 가져와서 인수 중 조건을 바꾸는게 좋을 수 있음
- 하이퍼링크 제거
  - 홈 > 하이퍼링크 제거(지우개 모양 아이콘) : 해제만 되고 기존 글, 객체는 남음
  - 홈 > 착지 및 선택 > 이동 옵션에서 개체를 선택하고 제거
- 서식 / 표시 형식 : 양수 - 음수 - 0 - 문자 순서대로 ;로 구분
- 테이블 선택하고 : 삽입 > 차트 만들기
  - 차트 제목도 수식 입력 가능

## 단축키

- 블록 이동 : Ctrl+Shift+방향키

## 파워쿼리

- 개요 : 한 번의 쿼리로 여러 외부데이터 파일 편집과 집계 등을 쉽게 할 수 있음
- 설치 : 2010, 2013은 설치해야 사용할 수 있음. 2016, 2019는 기본 등록
  - <https://www.microsoft.com/ko-kr/download/details.aspx?id=39379>
- 특징
  - 원본은 건드리지 않음
- 순서
  1. 파워쿼리에서 쓸 표를 확인
      - 필요한 외부 테이블은 데이터 가져오기
  2. 파워쿼리 > 테이블/범위에서로 파워쿼리 편집기 실행
  3. 파워쿼리 편집기에서 내용 수정
  4. 종료/로드로 새로운 시트 생성
- 활용
  - 크로스탭 표를 DB에 넣을 수 있는 목록으로 변경
  - 파일에 있는 분리된 시트 자동 취합
