# 데이터 모델링 심화

## 식별자 선정

- 규칙 : 유일성, 최소성, Not Null, 불변성
- 방법 : 대표성, 유일성을 참조, 주식별자속성이 많을 경우 대체키 활용
- 관계
  - 식별자(실선) : 의존적. FK가 식별에 반드시 필요(=부모가 반드시 필요).
  - 비식별자(점선) : 독립적. FK가 식별에 필요없고 자체 PK로 식별이 충분(FK가 아래로).

## 관계 선정

- BOM(Bill Of Material) : 하나의 엔터티 내에서 다대다관계를 맺는 형태
- 병렬관계 : 하나의 엔터티가 다른 엔터티와의 관계 역할에 따라 다른 기능을 수행
  - 부서-사원간 3종류의 점선이 그어진다던가
- 양쪽 다 선택 관계일 경우, 관계가 없는거나 다름이 없음 => 사이에 새로운 부모를 도출
- 배타적 선택 관계 : 상위 엔터티 유사시 통합
  - 주문이 개인고객, 법인고객이냐
- 관계 표현 하지 않기가 표현하기보다 중요(복잡성)
  - 관계는 FK도출을 중심으로

## 이력 모델링

- 종류
  - 변경이력 : 불특정시점 ; 주문변경, 계약변경
  - 발생이력 : 특정시점. 일자,상태코드를 활용 ; 급여계산, 요금청구, 청약관련
  - 진행이력 : 중간시점. 시작일자/종료일자가 동시에 존재가능(시점이력과 선분이력) ; 공사진행, 접수진행
- 모델링
  - 엔터티분리 : 무조건 식별자(실선)관계. 용량 감소.
    - 동일엔터티 : 회계/자금은 차변 대변 관리를 위해 한 엔터티에서 관리
    - 메타분리 : 하나의 이력엔터티로 여러 엔터티 이력관리
  - 최종여부 컬럼: SQL문이 달라짐
- 선분이력 vs 판이력
  - 선분이력 : 이력정보가 독립적. 새 이력 발생시 마스터에 영향 없이 기존 상세를 UPDATE후 INSERT
  - 판이력 : 이력정보에 반드시 마스터 이력이 필요.

## 인터페이스 모델링

- 내부 인터페이스 모델링 : 구축 시스템 내부 다른 업무 단위에 있는 엔터티와의 관계 모델링
- 외부 인터페이스 모델링 : 구축 시스템 외부 다른 시스템 엔터티 사용을 모델화
  - 오너십(주제영역)_엔터티명_IF 표기

## 코드 모델링

- 분류
  - 코드 + 코드명
  - 코드 + 코드명/추가속성 : 코드 엔터티 통합
- 특징
  - 잘 변하지 않음
  - 용량이 크지 않음
  - 많이 참조 됨
  - 사용 코드 갯수 만큼 해당 테이블의 다중 Join이 발생함
- 주의사항 : 코드나 코드값 변경시 변경해야하는 코드나 SQL(Decode)을 작성하지 말 것
