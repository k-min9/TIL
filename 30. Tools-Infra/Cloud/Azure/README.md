# Azure Fundamental

- 개요 : 애저 Cloud

## Azure 강의 개요

- 분야
  - 클라우드 개념
  - 핵심 Azure 서비스
  - Azure 솔루션 및 관리도구
  - Azure 보안 및 네트워크 보안
  - ID 거버넌스, 개인 규정 준수
  - Microsoft Cost Management 및 서비스 수준 계약(SLA)

## 클라우드 개념

- 개요 : 클라우드
  - 인터넷을 통해 컴퓨팅 서비스(서버, 스토리지, DB, 네트워킹, SW, 분석...)를 제공
- 종류
  - 공용
    - 클라우드 서비스 또는 호스팅 공급자가 소유
    - 여러 조직과 사용자에게 리소스와 서비스를 제공
    - 보안 네트워크 연결을 통해 엑세스(일반적으로)
    - 인프라 구축이 필요 없으므로 자본 지출이 발생하지 않음
      - 사용한 만큼만 지불, 종량제 가격 책정 모델
  - 사설(Private)
    - 조직의 데이터 센터에 클라우드 환경
    - 조직이 서비스 운영의 책임을 짐
    - 외부 사용자는 엑세스 불가
    - 시작 및 유지 관리를 위한 인프라 구축 비용이 발생
  - 하이브리드 : 공용 + 사설
    - 유연하고 유동적인 활용이 가능
- 이점 : 고가용성, 내결함성, 확장성, 탄력성, 글로벌 지원, 응답 속도, 민첩성, 예측가능 비용
- 비용
  - Capex(자본 지출) : 기존 서버. 물리적 운영. 초기비용이 크고 가치가 상각
  - OpEx(운영 비용) : 초기 비용이 없고, 서비스에 따른 비용 지불
- 서비스 모델 : 개발자(테넌트)의 책임 수준으로 Iaas(Infra) > PaaS(Platform) > SaaS(Software) 로 나뉨.
  - 우측으로 갈 수록 클라우드 공급자의 역할이 커지고 유연성이 떨어짐
  - 키워드
    - IaaS : Azure Storage, VM, Azure Files
    - PaaS : Azure App Service, 수정이 필요한 최소 관리(Web app), SQL DB, Cosmos DB, Azure BackUp, DNS
    - SaaS : Microsoft Dynamic 365
- 서버리스 컴퓨팅 : 개발자가 인프라를 관리할 필요없이 클라우드 서비스 공급자가 인프라를 자동으로 프로비저닝, 스케일링, 관리함
  - 확장성이 뛰어나고 함수나 트리거가 발생할때만 리소스를 사용
  - 서버리스도 서버에 계속 실행됨. '서버의 관리가 필요 없음'이어서 서버리스
- Azure
  - 기능
    - 미래 대비 : 지속적 혁신과 미래 제품 비전
    - 조건부 빌드 : 모든 언어 및 프레임 워크 지원을 통해 원하는 방식으로 빌드하고 원하는 위치에 배포
    - 원활한 하이브리드 운영 : on-premise, cloud, edge등 원하는 위치에서 운영
    - 높은 신뢰성
  - 작동 방식 - 가상화(Virtualization) : 하이퍼바이저라는 추상화 계층으로 HW와 OS간의 긴밀한 결합을 분리, 여러대의 VM이나 최적화된 규모 등을 Manage
  - 추가 기능
    - Azure Portal :GUI를 통한 웹 기반의 통합 콘솔로 구독을 관리
    - Azure Marketplace : 솔루션과 서비스 공급자 등을 사용자와 연결

## Azure 아키텍쳐 구성요소

- 구조 : Azure 계정 / 관리 그룹 - 구독 - 리소스 그룹 - 리소스
  - 계정
    - 계정을 통한 액세스 권한 구매
    - 무료 체험 : 12개월 몇몇 인기서비스 무료 제공 + 30일짜리 크레딧 제공 + 기본 무료 제공 서비스
  - 구독 : Azure 서비스 인증과 권한 부여 액세스 제공. 계정에 연결된 Azure 서비스의 논리적 단위
    - 리소스 그룹화 및 사용자 제한, 할당량 관리, 특정 리소스만 적용 등등...
    - 관리 그룹 : 구독을 관리 그룹 컨테이너에 구성하고 거버넌스 조건을 관리 그룹에 적용하여 소속 구독들에 조건을 자동 상속
  - 리소스 : VM, SQL DB, Storage 등 서비스 인스턴스
    - 리소스 그룹 : 리소스들을 묶어서 관리하는 논리 컨테이너. 중첩할 수 없음.
      - 리소스 그룹에서 작업 또는 설정시 하위 리소스들에 일괄적용
    - 리소스 매니저(ARM. Azure Resource Manager) : Azure용 배포 및 관리 서비스. 리소스를 만들고, 업데이트하고, 삭제하는 관리 계층
      - Azure 도구, API, SDK에서 요청을 보내면 받고, 인증하고 권한을 부여하거나 서비스에 요청하는 곳
- 특성
  - 중복 및 복제기능을 통한 내구성과 가용성
  - 자동 암호화와 역할기반 액세스제어를 통한 보안 유지
  - 확장성
  - 어느 곳에서도 액세스할 수 있음
- 지역 : 물리적 영역. 네트워크 연결 데이터 센터를 하나 이상 포함하는 지리적 영역
  - 사용자와 가까운 위치에서 애플리케이션을 제공할 수 있고, 글로벌로 향상된 확장성과 중복성을 제공
  - 단일 지역은 최소 세개의 영역으로 구성
  - 가용성 영역 : Azure 지역 내 분리된 데이터 센터, 한 영역이 다운되어도 다른 영역에서 계속 작동
    - FailOver(장애조치)를 위해 지역 쌍을 이룸. 300마일 이상 떨어진 지역에 리소스를 복제
      - ex) 미국 동부/서부 쌍, 동남아시아/동아시아 쌍

## Azure 서비스

- 작업
  - PowerShell CLI 제공
  - Bash 입력하여 Bash CLI로 변경 가능
  - Azure CLI 대화형 모듈 사용
    - 자동완성 제공
  - Azure 포탈 사용
- 명령어 예시
  - az version : CLI 버전 확인
  - az upgrade : CLI 버전 업데이트
  - az interactive : 대화형 모드 사용
  - az vm create : Linux 가상 머신 만들기
- 앱 환경
  - Azure에서 VM 만들기
    - 가용성 집합 : 업데이트 및 장애 도메인을 따라 VM 업데이트에 시차를 둠
  - Azure Virtual Desktop : 클라우드 실행되는 데스크톱 및 애플리케이션 가상화 서비스
  - Azure 컨테이너 : 단일 운영체제로 제한 되는 VM과 다르게 가볍고 민첩하게 주문형 변경에 대응하게 설계
    - PaaS 서비스로 Azure Container Instances 서비스 제공
  - Azure Functions : 이벤트 기반 서버리스 컴퓨팅 옵션. VM 컨테이너와 다르게 실행 중일 필요 없이 이벤트로 기능이 깨어남.
  - 호스팅 옵션
    - Azure App Service : 인프라 관리 필요 없이 자동배포, 지속 배포, 보안 설정, 부한 분산등을 지원하는 http 기반 서비스
      - 여러 언어 및 Windows/Linux 환경 등 모두 지원
- Azure Virtual Network
  - 격리 및 구분 : 격리된 여러 가상 네트워크를 생성
  - 인터넷 통신 : 리소스간 온-프레미스 등
  - 트래픽 라우팅 : 게이트웨이 등의 기능
  - 트래픽 필터링 : 보안그룹, 방화벽 실행, 광역 네트워크(WAN) 최적화 수행
- 가상 사설망(VPN) : 신뢰할 수 있는 사설망을 신뢰할 수 없는 네트워크를 통해 연결하기 위해 사용
  - 중요 정보를 안전하게 보안을 유지하며 공유
  - VPN Gateway : 1개의 VPN마다 1개의 GateWay만 배포 가능. Gateway를 통해 여러 위치에 연결
    - 분류 : 암호화할 트래픽 지정 방식
      - 정책기반 : 암호화되어야 하는 패킷의 IP 주소 지정
      - 경로기반 : IPSec 터널을 네트워크 인터페이스로 모델링하고 라우팅에 따라 터널 인터페이스를 결정. 온-프레미스에 적절
- Azure DNS : 도메인용 호스팅 서버
- Azure Storage
  - 계정 : 모든 스토리지 계정에 고유한 Azure 계정 이름이 있어야 함
    - 유형
      - LRS(로컬 중복 스토리지)
      - GRS(지역 중복 스토리지)
      - RA-GRS(읽기 액세스 지역 중복 스토리지)
      - ZRS(영역 중복 스토리지)
      - GZRS(지역 영역 중복 스토리지)
      - RA-GZRS(읽기 액세스 지역 영역 중복 스토리지)
    - 중복성 : 데이터 보호를 위한 복사본 저장으로 가용성 및 내구성
      - 기본지역 : 주 지역에 복제. LRS, ZRS
      - 보조지역 : 수백km 떨어진 지역에 추가 복제. GRS, GZRS. failover가 없는 한 데이터를 읽거나 쓸 수 없음
      - 지역영역중복 : 최고 수준의 내구성을 제공
  - 플랫폼
    - Blob : 텍스트 및 이진 데이터. 비디오 및 오디오 스트리밍. 빅데이터 분석지원도 있음
      - 액세스 계층 : 접근빈도에 따라 액세스비용이 싸고 저장비용이 비싼 방식 등을 채택할 수 있음
        - 핫 액세스 계층 : 자주 액세스하는 데이터 최적화
        - 쿨 액세스 계층 : 자주 액세스 하지 않고 30일 이상 저장하는 데이터
        - 보관 액세스 계층 : 거의 액세스 하지 않고 180일 이상 보관
    - Files : 파일 공유. SMB(서버 메시지 블록) 또는 NFS(네트워크 파일 시스템)을 통해 액세스
    - 큐 : 메시징 저장소. 메시지 단일 최대 크기는 64kb
    - 디스크 : VM용 블록 수준 스토리지 볼륨
  - 파일 동기화 : 서버와 클라우드 환경간에 파일을 자동으로 업데이트
- Azure ID, 액세스 및 보안 설명
  - Active Directory(AD) : Microsoft Cloud App과 개발App 모두에 로그인하고 액세스 할 수 있는 디렉토리 서비스
    - Azure AD : 클라우드 기반 ID 및 액세스 관리 서비스. 사용자 보호나 로그인 시도 감지 등을 지원.
      - 기능 : 인증, SSO, App 관리, 디바이스 등록 등을 통한 액세스 관리
      - Azure AD Connect : 온-프레미스와 Azure AD 연결
  - 인증
    - SSO : Single Sign-On하나만 로그인 하면 애플리케이션 전반에 걸친 액세스 권한을 부여
    - 다단계 인증 : 로그인 중 식별을 위한 추가 양식을 요청. 사용자가 아는것, 가진것, 존재(지문)등을 사용
      - Azure AD Multi-Factor Authentication 서비스로 추가 인증 형식을 선택할 수 있게 지원
    - 암호없는 인증
      - 비지니스용 Windows Hello : 해당 PC로 연결
      - Authenticator 앱 : 해당 앱을 사용한 자격 증명. 앱의 숫자를 입력하고 생체 인식 데이터 등을 입력
      - FIDO2 보안 키 : Fast IDentity Online Alliance. 피싱이 불가능한 표준 기반의 암호 없는 인증 방법.
  - 외부 ID : 조직 외부 사용자와 안전하게 상호작용
    - Azure Active Directory for External Identities로 제공
  - 역할기반 액세스 제어(RBAC) : 해당 유저를 같은 그룹에 추가하면 동일한 액세스 권한이 자동 부여
    - 범위 : 관리그룹(구독의 모음), 단일 구독, 리소스 그룹, 단일 리소스
    - 여러 역할 할당시 모든 역할에 할당된 모든 권한을 부여
  - Zero trust 모델 : 최악의 시나리오를 가정하고 리소스를 보호하는 보안모델
  - 심층 방어 : 데이터 무단 액세스를 막기 위해 진행속도를 늦추는 여러 매커니즘을 사용하는 전략\
